<div class="bg-background dark:bg-dark-background">
  <div class="container py-12">
    <div class="flex flex-col items-center justify-center space-y-2">
      <h4 class="text-primary dark:text-dark-primary text-xl font-medium">
        Trend<span class="text-foreground dark:text-dark-foreground">Loom</span>
      </h4>
      <h3 class="text-2xl text-foreground dark:text-dark-foreground font-bold">Welcome back</h3>
      <p class="text-muted-foreground mb-6 dark:text-dark-muted-foreground">
        Sign in to your account to continue
      </p>
      <form
        [formGroup]="signinForm"
        (ngSubmit)="onSigninSubmit()"
        class="w-[90%] md:w-[500px] space-y-4 md:space-y-6 border border-border dark:border-dark-border rounded-lg px-4 md:px-10 py-4 md:py-6"
      >
        <div>
          <label
            for="email"
            class="block mb-2 text-sm font-medium text-foreground dark:text-dark-foreground"
            >Email <span class="text-destructive">*</span></label
          >
          <input
            type="email"
            id="email"
            formControlName="email"
            class="w-full bg-transparent p-2 border border-border dark:border-dark-border rounded-md text-sm text-foreground dark:text-dark-foreground focus:outline-none focus:ring-2 focus:ring-accent dark:focus:ring-dark-accent"
            placeholder="name@company.com"
            required
          />
          @if (
            getControl('email')?.invalid &&
            (getControl('email')?.touched || getControl('email')?.dirty)
          ) {
            <div class="error">
              @if (getControl('email')?.errors?.['required']) {
                <small>email is required</small>
              }
              @if (getControl('email')?.errors?.['invalidEmail']) {
                <small>invalid email format</small>
              }
            </div>
          }
        </div>
        <div class="relative">
          <label
            for="password"
            class="block mb-2 text-sm font-medium text-foreground dark:text-dark-foreground"
            >Password <span class="text-destructive">*</span></label
          >
          <input
            type="{{ showPassword() ? 'text' : 'password' }}"
            id="password"
            placeholder="password"
            formControlName="password"
            class="w-full bg-transparent p-2 border border-border dark:border-dark-border rounded-md text-sm mb-1 text-foreground dark:text-dark-foreground focus:outline-none focus:ring-2 focus:ring-accent dark:focus:ring-dark-accent"
            required
          />
          <div
            class="absolute top-[40%] right-4 cursor-pointer max-w-[40px]"
            role="button"
            tabindex="0"
            (click)="toggleShowPassword()"
            (keydown)="onKeyDown($event)"
            aria-label="Toggle password visibility"
          >
            @if (showPassword()) {
              <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                <path stroke="currentColor" stroke-width="2" d="M21 12c0 1.2-4.03 6-9 6s-9-4.8-9-6c0-1.2 4.03-6 9-6s9 4.8 9 6Z"/>
                <path stroke="currentColor" stroke-width="2" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/>
              </svg>
            } @else {
              <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.933 13.909A4.357 4.357 0 0 1 3 12c0-1 4-6 9-6m7.6 3.8A5.068 5.068 0 0 1 21 12c0 1-3 6-9 6-.314 0-.62-.014-.918-.04M5 19 19 5m-4 7a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/>
              </svg>
            }
          </div>
          @if (
            getControl('password')?.invalid &&
            (getControl('password')?.touched || getControl('password')?.dirty)
          ) {
            <div class="error">
              @if (getControl('password')?.errors?.['required']) {
                <small>password is required</small>
              }
              @if (getControl('password')?.errors?.['invalidPassword']) {
                <small>password is not strong enough</small>
              }
            </div>
          }
          <a
            routerLink="/{{ forgotPasswordRoute }}"
            class="text-sm font-medium text-primary hover:underline"
            >Forgot password?</a
          >
        </div>
        <button
          type="submit"
          [disabled]="signinForm.invalid || isLoading"
          class="w-full btn hover-accent hover-ring-accent theme-transition disabled:cursor-not-allowed disabled:bg-muted disabled:dark:bg-muted-foreground"
        >
          @if (!isLoading) {
            <p>Sign in</p>
          } @else {
            <span class="flex items-center gap-[10px]">
              <app-spinner />
              <p>Signing in...</p>
            </span>
          }
        </button>
        <p class="text-sm text-center font-light text-gray-500 dark:text-gray-400">
          Don't have an account yet?
          <a routerLink="/{{ signupRoute }}" class="font-medium text-accent">Sign up</a>
        </p>
      </form>
    </div>
  </div>
</div>
